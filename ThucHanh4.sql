--1
create table Doctor (
    DoctorID number GENERATED by default on null as IDENTITY primary key,
    DoctorName varchar2(200),
    DepartmentName varchar2(200),
    HospitalID number,
    City varchar2(200),
    Salary number
);

create table Patient (
    PatientID number GENERATED by default on null as IDENTITY primary key, 
    PatientName varchar2(200), 
    Sex varchar2(10) check (Sex in ('Female', 'Male', 'Other')), 
    BirthDate date, 
    Address varchar2(200), 
    City varchar2(200), 
    Phone varchar2(10), 
    Disease varchar2(200), 
    Bed number, 
    Room varchar2(20), 
    HospitalID number
);

create table Hospital (
    HospitalID number GENERATED by default on null as IDENTITY primary key, 
    HospitalName varchar2(200),
    Address varchar2(200),
    City varchar2(200)
);

create table Treatment (
    DoctorID number,
    PatientID number,
    TypeofTreatment varchar2(200)
);

--2
alter table Patient add constraint Patient_Hospital_FK foreign key (HospitalID) references Hospital(HospitalID);
alter table Treatment add constraint Treatment_Patient_FK foreign key (PatientID) references Patient(PatientID);
alter table Treatment add constraint Treatment_Doctor_FK foreign key (DoctorID) references Doctor(DoctorID);
alter table Doctor add constraint Doctor_Hospital_FK foreign key (HospitalID) references Hospital(HospitalID);

--3
insert into Hospital values (1, 'Saigon Hospital', '123 Adress A', 'Sai go');
insert into Hospital values (2, 'Hospital B', '456 Adress B', 'Ha Noi');
insert into Hospital values (3, 'Hospital C', '789 Adress C', 'Ha Noi');

insert into Doctor values (1, 'Jaspal', 'Department A', 1, 'Sai Go', 56000);
insert into Doctor values (2, 'Yuzery', 'Department B', 2, 'Ha Noi', 60000);
insert into Doctor values (3, 'Yuri', 'Department C', 3, 'Ha Noi', 40000);
insert into Doctor values (4, 'John', 'Department B', 2, 'Ha Noi', 57000);

insert into Patient values (1, 'Nguyen Van A', 'Male', '12-SEP-2000', '123 Address ABC', 'Ha Noi', '0324547891', 'Cancer', 1, '679', 1);
insert into Patient values (2, 'Nguyen Van B', 'Male', '13-SEP-2000', '321 Address ABC', 'Ha Noi', '0324547892', 'Dau Ruot Thua', 2, '679', 2);
insert into Patient values (3, 'Nguyen Van C', 'Male', '14-SEP-1999', '123 EDF ABC', 'Ha Noi', '0324547893', 'Gay Tay', 3, '279', 3);
insert into Patient values (4, 'Nguyen Van D', 'Male', '19-JAN-2000', '111 Address Loi', 'Ha Noi', '0324547894', 'Cancer', 1, '222', 2);
insert into Patient values (5, 'Nguyen Thu A', 'Female', '19-DEC-1955', '123 CDE ABC', 'Ha Noi', '0324547895', 'Nhuc Dau', 2, '123', 1);
insert into Patient values (6, 'Le Van A', 'Male', '19-NOV-1960', '123 XYX ABC', 'Ha Noi', '0324547896', 'Loet Da Day', 1, '111', 1);
insert into Patient values (7, 'Nguyen Van A', 'Male', '19-SEP-2001', '321 Address ABC', 'Ha Noi', '0324547897', 'Gay Cha', 1, '659', 2);
insert into Patient values (8, 'Nguyen Van A', 'Male', '11-JUN-1998', '123 ABC ABC ABC', 'Ha Noi', '0324547898', 'Dau Mat', 1, '479', 3);
insert into Patient values (9, 'Tran Van A', 'Male', '19-SEP-2000', '222 ABC ABC', 'Ha Noi', '0324547899', 'Viem Ga', 1, '629', 2);
insert into Patient values (10, 'Nguyen Thi D', 'Female', '19-AUG-1997', '123 DIU ABC', 'Ha Noi', '0324547811', 'Cancer', 1, '379', 3);

insert into Treatment values (1, 1, 'Treatment A');
insert into Treatment values (2, 2, 'Treatment B');
insert into Treatment values (3, 3, 'Treatment B');
insert into Treatment values (2, 4, 'Treatment A');
insert into Treatment values (1, 5, 'Treatment B');
insert into Treatment values (1, 6, 'Treatment A');
insert into Treatment values (2, 7, 'Treatment A');
insert into Treatment values (3, 8, 'Treatment B');
insert into Treatment values (2, 9, 'Treatment A');
insert into Treatment values (3, 10, 'Treatment B');

--4a
select p.PatientName as Name, p.Address from Patient p, Treatment t, Doctor d 
where p.City = 'Ha Noi' and t.PatientID = p.PatientID and t.DoctorID = d.DoctorID and d.DoctorName='Jaspal' ;
--4b
select d.DoctorName as Name, d.Salary from Patient p, Doctor d, Hospital h
where p.HospitalID = h.HospitalID and h.HospitalID = d.HospitalID and p.Disease like '%Cancer%' and d.Salary > 55000;
--4c
select p.PatientName as Name, p.Sex, floor(months_between(Trunc(sysdate), p.BirthDate)/12) as Age from Patient p,  Hospital h
where p.HospitalID = h.HospitalID and p.Room = '679' and h.HospitalName = 'Saigon Hospital';
--4d
select PatientName as Name, floor(months_between(Trunc(sysdate), BirthDate)/12) as Age, Phone from Patient where Sex = 'Female';
--4e
select d.DoctorName as Name from Patient p, Doctor d, Hospital h
where p.HospitalID = h.HospitalID and h.HospitalID = d.HospitalID and p.Sex = 'Female' and months_between(Trunc(sysdate), p.BirthDate)/12 > 60;